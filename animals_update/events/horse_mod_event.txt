namespace = ani_plus

###### horse update event
### event 170 - ?

## conversion quest
# event 170: event to launch quest by event rule
# event 171: removing quest cooldown
# event 172: finished the preparation
#       can lead to event 173: everything went well
#       can lead to event 174: unknown illness due to an hypnotic state
#       can lead to event 175: an accident occure

# event 170
province_event = {
    id = ani_plus.170

    border = GFX_event_normal_frame_diplomacy
    picture = GFX_evt_council

    trigger = {
        has_game_rule = {
            name = animals_conversion_ways
            value = animal_events
        }
        Is_really_animal_trigger = no
        holder_scope = {
            Is_really_animal_trigger = no
            OR = {
                lifestyle_traits == 0
                trait = hunter
            }
            is_nomadic = no
            wealth = 35
        }
        terrain = steppe
        NOT = { has_province_flag = horse_conv_quest_CD }
        OR = {
            has_building = tb_steppe_barracks_1
            has_building = tb_steppe_stable_1
            has_building = ca_steppe_stable_1
            has_building = ca_steppe_barracks_1
            has_building = tb_default_horse_conv_quest
            has_building = ca_default_horse_conv_quest
        }
    }

    mean_time_to_happen = {
        years = 200

        modifier = {
            factor = 0.25  # 50 years for players
            holder_scope = { ai = no }
        }
    }

    desc = DESC_ani_170

    immediate = {
        set_province_flag = horse_conv_quest_CD
    }

    option = {
        name = OPTA_ani_170
        FROM = {
            wealth = -35
            piety = -100
        }

        province_event = { id = ani_plus.172 days = 7 random = 7 }
    }
    option = {
        name = OPTB_ani_170
    }
    
    after = {
        province_event = { id = ani_plus.171 years = 10 }
    }
}

# event 171
province_event = {
    id = ani_plus.171
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        remove_province_modifier = horse_conv_quest_CD
    }
}

# event 172
province_event = {
    id = ani_plus.172

    border = GFX_event_normal_frame_diplomacy
    picture = GFX_evt_council

    is_triggered_only = yes

    desc = DESC_ani_172

    option = {
        name = OPT_ani_172
    }
}